function runWodPlanner(t, e) {
    let d = ""
      , c = ""
      , H = ""
      , N = 0
      , o = null
      , h = null
      , g = null
      , v = []
      , S = null
      , n = ""
      , r = ""
      , a = ""
      , oe = ""
      , l = ""
      , ue = ""
      , f = ""
      , w = ""
      , b = ""
      , I = ""
      , G = ""
      , O = ""
      , se = ""
      , de = ""
      , Q = ""
      , R = ""
      , T = ""
      , M = ""
      , L = ""
      , ce = ""
      , x = ""
      , B = ""
      , _ = ""
      , q = ""
      , fe = ""
      , E = ""
      , U = ""
      , F = ""
      , he = ""
      , ge = ""
      , ve = null
      , me = null
      , pe = null
      , ke = null
      , Ae = null
      , $e = null
      , we = null
      , be = null
      , Ie = null
      , Ge = null
      , Qe = null
      , Re = null
      , Te = null
      , Me = null
      , Le = null
      , xe = null
      , Be = null
      , _e = null
      , qe = null
      , Se = null
      , Pe = null
      , ye = !1
      , De = !1
      , V = null;
    const u = new Map
      , J = new Map;
    let We = []
      , Ce = []
      , Ee = []
      , Ue = []
      , Fe = []
      , He = []
      , Ne = []
      , Oe = 0
      , Ve = 0;
    const P = {
        Knight: "knight",
        Druid: "druid",
        Sorcerer: "sorcerer",
        Paladin: "paladin",
        t: "TopLeft",
        l: "TopRight",
        i: "BottomLeft",
        o: "BottomRight",
        QTL0: "QTL0",
        QTL1: "QTL1",
        QTL2: "QTL2",
        QTL3: "QTL3",
        QTL4: "QTL4",
        QTL5: "QTL5",
        QTL6: "QTL6",
        QTL7: "QTL7",
        QTL8: "QTL8",
        QTR0: "QTR0",
        QTR1: "QTR1",
        QTR2: "QTR2",
        QTR3: "QTR3",
        QTR4: "QTR4",
        QTR5: "QTR5",
        QTR6: "QTR6",
        QTR7: "QTR7",
        QTR8: "QTR8",
        QBL0: "QBL0",
        QBL1: "QBL1",
        QBL2: "QBL2",
        QBL3: "QBL3",
        QBL4: "QBL4",
        QBL5: "QBL5",
        QBL6: "QBL6",
        QBL7: "QBL7",
        QBL8: "QBL8",
        QBR0: "QBR0",
        QBR1: "QBR1",
        QBR2: "QBR2",
        QBR3: "QBR3",
        QBR4: "QBR4",
        QBR5: "QBR5",
        QBR6: "QBR6",
        QBR7: "QBR7",
        QBR8: "QBR8",
        u: "Unique",
        h: "SkillBonus",
        g: "Leech",
        v: "Augmentation",
        m: "VesselResonance",
        p: "Other",
        k: "ModEffect",
        A: "ModAugmentation",
        $: "ModRevelation"
    }
      , m = {
        I: "#46b21c31",
        G: "#94c4126b",
        R: "#ae143431",
        T: "#ef1a386b",
        M: "#198d4031",
        L: "#18cd8f6b",
        B: "#841d9e31",
        _: "#e618da6b",
        q: "#80808067",
        S: 2,
        P: Math.PI / 180,
        D: 180 / Math.PI
    };
    let z = P.Knight
      , Z = []
      , K = []
      , j = null
      , X = null
      , Y = null
      , ee = null
      , ne = null
      , te = null;
    const p = 261
      , k = [{
        id: P.QTL0,
        radiusIndex: 0,
        startAngleGrad: 180,
        endAngleGrad: 270,
        quarter: P.t
    }, {
        id: P.QTL1,
        radiusIndex: 1,
        startAngleGrad: 180,
        endAngleGrad: 225,
        quarter: P.t
    }, {
        id: P.QTL3,
        radiusIndex: 1,
        startAngleGrad: 225,
        endAngleGrad: 270,
        quarter: P.t
    }, {
        id: P.QTL2,
        radiusIndex: 2,
        startAngleGrad: 180,
        endAngleGrad: 210,
        quarter: P.t
    }, {
        id: P.QTL4,
        radiusIndex: 2,
        startAngleGrad: 210,
        endAngleGrad: 240,
        quarter: P.t
    }, {
        id: P.QTL6,
        radiusIndex: 2,
        startAngleGrad: 240,
        endAngleGrad: 270,
        quarter: P.t
    }, {
        id: P.QTL5,
        radiusIndex: 3,
        startAngleGrad: 195,
        endAngleGrad: 225,
        quarter: P.t
    }, {
        id: P.QTL7,
        radiusIndex: 3,
        startAngleGrad: 225,
        endAngleGrad: 255,
        quarter: P.t
    }, {
        id: P.QTL8,
        radiusIndex: 4,
        startAngleGrad: 195,
        endAngleGrad: 255,
        quarter: P.t
    }, {
        id: P.QTR0,
        radiusIndex: 0,
        startAngleGrad: 270,
        endAngleGrad: 360,
        quarter: P.l
    }, {
        id: P.QTR3,
        radiusIndex: 1,
        startAngleGrad: 270,
        endAngleGrad: 315,
        quarter: P.l
    }, {
        id: P.QTR1,
        radiusIndex: 1,
        startAngleGrad: 315,
        endAngleGrad: 360,
        quarter: P.l
    }, {
        id: P.QTR6,
        radiusIndex: 2,
        startAngleGrad: 270,
        endAngleGrad: 300,
        quarter: P.l
    }, {
        id: P.QTR4,
        radiusIndex: 2,
        startAngleGrad: 300,
        endAngleGrad: 330,
        quarter: P.l
    }, {
        id: P.QTR2,
        radiusIndex: 2,
        startAngleGrad: 330,
        endAngleGrad: 360,
        quarter: P.l
    }, {
        id: P.QTR7,
        radiusIndex: 3,
        startAngleGrad: 285,
        endAngleGrad: 315,
        quarter: P.l
    }, {
        id: P.QTR5,
        radiusIndex: 3,
        startAngleGrad: 315,
        endAngleGrad: 345,
        quarter: P.l
    }, {
        id: P.QTR8,
        radiusIndex: 4,
        startAngleGrad: 285,
        endAngleGrad: 345,
        quarter: P.l
    }, {
        id: P.QBL0,
        radiusIndex: 0,
        startAngleGrad: 90,
        endAngleGrad: 180,
        quarter: P.i
    }, {
        id: P.QBL3,
        radiusIndex: 1,
        startAngleGrad: 90,
        endAngleGrad: 135,
        quarter: P.i
    }, {
        id: P.QBL1,
        radiusIndex: 1,
        startAngleGrad: 135,
        endAngleGrad: 180,
        quarter: P.i
    }, {
        id: P.QBL6,
        radiusIndex: 2,
        startAngleGrad: 90,
        endAngleGrad: 120,
        quarter: P.i
    }, {
        id: P.QBL4,
        radiusIndex: 2,
        startAngleGrad: 120,
        endAngleGrad: 150,
        quarter: P.i
    }, {
        id: P.QBL2,
        radiusIndex: 2,
        startAngleGrad: 150,
        endAngleGrad: 180,
        quarter: P.i
    }, {
        id: P.QBL7,
        radiusIndex: 3,
        startAngleGrad: 105,
        endAngleGrad: 135,
        quarter: P.i
    }, {
        id: P.QBL5,
        radiusIndex: 3,
        startAngleGrad: 135,
        endAngleGrad: 165,
        quarter: P.i
    }, {
        id: P.QBL8,
        radiusIndex: 4,
        startAngleGrad: 105,
        endAngleGrad: 165,
        quarter: P.i
    }, {
        id: P.QBR0,
        radiusIndex: 0,
        startAngleGrad: 0,
        endAngleGrad: 90,
        quarter: P.o
    }, {
        id: P.QBR1,
        radiusIndex: 1,
        startAngleGrad: 0,
        endAngleGrad: 45,
        quarter: P.o
    }, {
        id: P.QBR3,
        radiusIndex: 1,
        startAngleGrad: 45,
        endAngleGrad: 90,
        quarter: P.o
    }, {
        id: P.QBR2,
        radiusIndex: 2,
        startAngleGrad: 0,
        endAngleGrad: 30,
        quarter: P.o
    }, {
        id: P.QBR4,
        radiusIndex: 2,
        startAngleGrad: 30,
        endAngleGrad: 60,
        quarter: P.o
    }, {
        id: P.QBR6,
        radiusIndex: 2,
        startAngleGrad: 60,
        endAngleGrad: 90,
        quarter: P.o
    }, {
        id: P.QBR5,
        radiusIndex: 3,
        startAngleGrad: 15,
        endAngleGrad: 45,
        quarter: P.o
    }, {
        id: P.QBR7,
        radiusIndex: 3,
        startAngleGrad: 45,
        endAngleGrad: 75,
        quarter: P.o
    }, {
        id: P.QBR8,
        radiusIndex: 4,
        startAngleGrad: 15,
        endAngleGrad: 75,
        quarter: P.o
    }]
      , Je = [{
        quarter: P.t
    }, {
        quarter: P.l
    }, {
        quarter: P.i
    }, {
        quarter: P.o
    }];
    function ze(e) {
        switch (e) {
        case P.t:
            return m.I;
        case P.l:
            return m.R;
        case P.i:
            return m.M;
        case P.o:
            return m.B;
        default:
            return m.I
        }
    }
    function Ze(e) {
        switch (e) {
        case P.t:
            return m.G;
        case P.l:
            return m.T;
        case P.i:
            return m.L;
        case P.o:
            return m._;
        default:
            return m.G
        }
    }
    function Ke(e) {
        return e * (50 + m.S) + 1
    }
    function je(e) {
        return Ke(e) + 50
    }
    function Xe(e) {
        var n = e.x - p
          , t = e.y - p
          , r = Math.sqrt(n * n + t * t);
        let a = Math.atan(t / n) * m.D
          , l = (n < 0 ? a += 180 : 0 < n && t < 0 && (a += 360),
        null);
        for (const u of k) {
            var i = Ke(u.radiusIndex) - m.S / 2
              , o = je(u.radiusIndex) + m.S / 2;
            if (i <= r && r <= o && u.startAngleGrad <= a && a < u.endAngleGrad) {
                l = u.id;
                break
            }
        }
        return l
    }
    function Ye(e) {
        for (let t = 0; t < v.length; t++) {
            var n = v[t];
            if (n.W(e))
                return n.quarter
        }
        return null
    }
    function en(e) {
        for (let t = 0; t < v.length; t++) {
            var n = v[t];
            if (n.C(e))
                return n.quarter
        }
        return null
    }
    function nn(e, n, t, r) {
        g.beginPath(),
        0 == e ? g.moveTo(p, p) : g.arc(p, p, e, t, r, !1),
        g.arc(p, p, n, r, t, !0),
        g.closePath()
    }
    function tn(e, n) {
        g.beginPath(),
        1 != e && g.moveTo(n.U, n.F),
        g.arc(n.U, n.F, n.H, -90 * m.P, (360 * e - 90) * m.P, !1),
        g.closePath()
    }
    function rn() {
        g.save();
        for (const h of k) {
            let e = 0
              , n = !1;
            var t = Z.find(e=>e.id === h.id);
            t && (e = t.fillPercent,
            n = t.unlocked),
            r = h.radiusIndex,
            a = h.startAngleGrad,
            l = h.endAngleGrad,
            i = h.quarter,
            o = e,
            u = n,
            f = c = d = s = t = void 0,
            t = a * m.P,
            s = l * m.P,
            d = Ke(r),
            c = je(r),
            f = d + o * (c - d),
            f = o < .5 ? Math.ceil(f) : Math.floor(f),
            0 < o && (nn(d, f, t, s),
            A(Ze(i))),
            u && (nn(d, c, t, s),
            A(ze(i)))
        }
        var r, a, l, i, o, u, s, d, c, f;
        g.restore()
    }
    function an() {
        var e, n, t, r;
        g.save(),
        null != j && (e = k.find(e=>e.id === j)) && (n = e.radiusIndex,
        t = e.startAngleGrad,
        r = e.endAngleGrad,
        nn(Ke(n), je(n), t * m.P, r * m.P),
        A(m.q)),
        g.restore()
    }
    function ln() {
        var e, n, t, r;
        g.save(),
        null != X && (e = k.find(e=>e.id === X)) && (n = e.radiusIndex,
        t = e.startAngleGrad,
        r = e.endAngleGrad,
        nn(Ke(n) - m.S / 2, je(n) + m.S / 2, t * m.P, r * m.P),
        g.lineWidth = m.S,
        g.strokeStyle = "white",
        g.stroke()),
        g.restore()
    }
    function on() {
        var e = $("#" + E);
        if (e && e[0]) {
            h = e[0],
            g = h.getContext("2d");
            {
                e = $("#" + E);
                let t = null
                  , r = null;
                function a() {
                    t = null,
                    r = null
                }
                e.on("contextmenu", function(e) {
                    return hn(e),
                    a(),
                    cn(e),
                    null != X && Pn(gn(e)),
                    !1
                }),
                e.on("click", function(e) {
                    hn(e),
                    cn(e)
                }),
                e.on("mousemove", function(e) {
                    var n, t, r, a;
                    e = e,
                    n = j,
                    t = Y,
                    r = ne,
                    a = fn(e),
                    j = Xe(a),
                    Y = Ye(a),
                    ne = en(a),
                    n === j && t === Y && r === ne || (un(),
                    kn(fe, j, Y, ne, !1))
                }),
                e.on("mouseout", function(e) {
                    j = null,
                    Y = null,
                    ne = null,
                    un()
                }),
                e.on("touchstart", function(e) {
                    e = e.originalEvent || e,
                    DeactivateHelperDiv(),
                    e.touches && 1 == e.touches.length && (t = new Date,
                    r = e.touches[0])
                }),
                e.on("touchmove touchcancel", function() {
                    a()
                }),
                e.on("touchend", function(e) {
                    var n;
                    hn(e),
                    r && t && (cn(r),
                    n = (new Date).getTime() - t.getTime(),
                    null != X) && 500 < n && Pn(),
                    a()
                })
            }
            re()
        }
    }
    function re() {
        if (ve && me && pe && ke && Ae && $e && we && be && Ie && Ge && Qe && Re && Te && Me && Le && xe && Be && _e && qe && Se && 0 < Z.length && 0 < K.length && ye && h && g) {
            switch (g.save(),
            g.drawImage(ve, 0, 0),
            g.restore(),
            rn(),
            j && an(),
            g.save(),
            z) {
            case P.Knight:
                sn(90);
                break;
            case P.Sorcerer:
                sn(180);
                break;
            case P.Paladin:
                sn(270);
                break;
            case P.Druid:
            }
            g.drawImage(Ae, 0, 0),
            g.restore();
            var e = Be.height
              , t = _e.height
              , l = {};
            l[P.t] = 0,
            l[P.l] = 0,
            l[P.i] = 0,
            l[P.o] = 0,
            g.save();
            for (let n = 0; n < k.length; n++) {
                var i = function(e) {
                    return (e.startAngleGrad + e.endAngleGrad) / 2 * m.P
                }(k[n])
                  , o = function(e) {
                    var n = (Ke(e.radiusIndex) + je(e.radiusIndex)) / 2;
                    return n + (n < je(0) ? 2 : 0)
                }(k[n])
                  , u = Math.round(Math.cos(i) * o + p - e / 2)
                  , i = Math.round(Math.sin(i) * o + p - e / 2)
                  , o = Z.find(e=>e.id === k[n].id)
                  , r = o.mediumPerkId
                  , s = o.smallPerkId;
                let a = !1;
                if (o.mediumPerkCategory === P.m && 1 === o.fillPercent) {
                    const f = k[n].quarter;
                    var d = K.find(e=>e.id === f);
                    if (d && d.hasGem && d.gemQuality >= l[f]) {
                        a = !0,
                        l[f]++;
                        let e = 0
                          , n = Le
                          , t = qe
                          , r = 0;
                        switch (l[f]) {
                        case 1:
                            e = d.keyBasicMod1;
                            break;
                        case 2:
                            e = d.keyBasicMod2;
                            break;
                        case 3:
                            e = d.keySupremeMod,
                            n = xe,
                            t = Se,
                            r = -5
                        }
                        var o = n.height
                          , c = t.height;
                        g.drawImage(t, 0, 0, c, c, u - 1, i - 1, c, c),
                        g.drawImage(n, e * o, 0, o, o, u, i + r, o, o)
                    }
                }
                a || g.drawImage(Be, r * e, 0, e, e, u, i, e, e),
                g.drawImage(_e, s * t, 0, t, t, u - 3, i + 17, t, t)
            }
            if (g.restore(),
            v.length !== Je.length) {
                v = [];
                let a = 0;
                Je.forEach(n=>{
                    var e = K.find(e=>e.id === n.quarter)
                      , t = ze(n.quarter)
                      , r = Ze(n.quarter);
                    switch (n.quarter) {
                    case P.t:
                        a = 180;
                        break;
                    case P.l:
                        a = 270;
                        break;
                    case P.i:
                        a = 90;
                        break;
                    default:
                        P.o;
                        a = 0
                    }
                    e = new Dn(e,t,r,a);
                    v.push(e)
                }
                )
            } else
                v.forEach(n=>{
                    var e = K.find(e=>e.id === n.quarter);
                    e && (n.largePerkId = e.largePerkId,
                    n.level = e.level,
                    n.fillPercent = e.fillPercent,
                    n.vesselLevel = e.vesselLevel,
                    n.hasGem = e.hasGem,
                    n.gemQuality = e.gemQuality,
                    n.socketBezelImgId = e.socketBezelImgId,
                    n.gemImgId = e.gemImgId)
                }
                );
            v.forEach(e=>{
                let n = $e;
                switch (e.level) {
                case 0:
                    n = $e;
                    break;
                case 1:
                    n = we;
                    break;
                case 2:
                    n = be;
                    break;
                default:
                    n = Ie
                }
                let t = me
                  , r = (0 < e.vesselLevel && (t = pe),
                0);
                switch (e.quarter) {
                case P.t:
                    r = 0;
                    break;
                case P.l:
                    r = 90;
                    break;
                case P.o:
                    r = 180;
                    break;
                case P.i:
                    r = 270;
                    break;
                default:
                    r = 0
                }
                var a, l, i;
                g.save(),
                r && sn(r),
                e.quarter != P.l && e.quarter != P.i || dn(t),
                g.drawImage(t, 0, 0),
                g.restore(),
                g.save(),
                tn((o = e).fillPercent, o),
                A(o.N),
                tn(1, o),
                A(o.O),
                g.restore(),
                g.save(),
                a = ((o = e).V + 40) * m.P,
                l = (o.V + 50) * m.P,
                g.beginPath(),
                g.arc(p, p, o.J, a, l, !1),
                g.arc(p, p, o.Z, l, a, !0),
                g.closePath(),
                A(o.N),
                A(o.N),
                A(o.N),
                g.restore(),
                (o = e).quarter === Y && (g.save(),
                tn(1, o),
                A(m.q),
                g.restore()),
                (o = e).quarter === ne && (g.save(),
                g.beginPath(),
                g.arc(o.K, o.j, o.X, 0 * m.P, 360 * m.P, !1),
                g.closePath(),
                A(m.q),
                g.restore());
                g.save(),
                r && sn(r),
                g.globalAlpha = .4,
                g.drawImage(ke, 0, 0),
                g.restore(),
                g.save(),
                r && sn(r),
                e.quarter != P.l && e.quarter != P.i || dn(n),
                g.drawImage(n, 0, 0),
                g.restore(),
                o = e,
                l = Ge.height,
                a = l / 2,
                i = o.U - a,
                a = o.F - a,
                g.save(),
                g.drawImage(Ge, o.largePerkId * l, 0, l, l, i, a, l, l),
                g.restore();
                var o = e
                  , o = (o.quarter === ee && (g.save(),
                i = Math.round(o.U - o.H + 1),
                a = Math.round(o.F - o.H + 1),
                g.drawImage(Qe, i, a),
                g.restore()),
                e)
                  , o = (o.hasGem && (l = Re.height,
                a = o.K - (i = l / 2),
                i = o.j - i,
                g.save(),
                g.drawImage(Re, o.gemImgId * l, 0, l, l, a, i, l, l),
                g.restore()),
                o = e,
                a = Te.height,
                i = a / 2,
                l = o.K - i,
                i = o.j - i,
                g.save(),
                g.drawImage(Te, o.socketBezelImgId * a, 0, a, a, l, i, a, a),
                g.restore(),
                e);
                o.quarter === te && (g.save(),
                l = Math.round(o.K - o.X - 1),
                i = o.quarter === P.t || o.quarter === P.l ? -2 : 0,
                i = Math.round(o.j - o.X + i),
                g.drawImage(Me, l, i),
                g.restore())
            }
            ),
            X && ln()
        }
    }
    function un() {
        h && g && (g.clearRect(0, 0, h.width, h.height),
        re())
    }
    function A(e) {
        g.fillStyle = e,
        g.globalCompositeOperation = "lighter",
        g.mozFillRule = "evenodd",
        g.fill("evenodd")
    }
    function sn(e) {
        g.translate(p, p),
        g.rotate(e * m.P),
        g.translate(-p, -p)
    }
    function dn(e) {
        g.translate(e.height / 2, e.width / 2),
        g.rotate(-90 * m.P),
        g.scale(-1, 1),
        g.translate(-e.width / 2, -e.height / 2)
    }
    function cn(e) {
        var n = X
          , t = ee
          , r = te
          , a = fn(e);
        X = Xe(a),
        ee = Ye(a),
        te = en(a),
        n === X && t === ee && r === te || (j === X && Y === ee && ne === te || (j = X,
        Y = ee,
        ne = te,
        kn(fe, j, Y, ne, !1)),
        un(),
        kn(O, X, ee, te, !0))
    }
    function fn(e) {
        var n = h.getBoundingClientRect();
        return {
            x: e.clientX - n.left,
            y: e.clientY - n.top
        }
    }
    function hn(e) {
        e.cancelable && e.preventDefault(),
        e.stopPropagation()
    }
    function gn(n) {
        if (n.altKey || n.shiftKey || n.ctrlKey) {
            let e = 1;
            return n.shiftKey && (e *= 10),
            n.ctrlKey && (e *= 100),
            e
        }
        return 0
    }
    function vn(e) {
        return /^$|^[-_.~a-zA-Z0-9]{3,90}$/.test(e)
    }
    function mn(n) {
        var e = $("#" + a + "_" + n);
        e && e[0] && (n === z && (e[0].setAttribute("checked", "checked"),
        e.prop("checked", !0)),
        e[0].addEventListener("click", function() {
            var e;
            (e = n) !== z && s(!1, null, "setVocation", u.get(e))
        }))
    }
    function pn(n) {
        if (n && n[0]) {
            let e = n.val().trim();
            var t = e.match(/code=([-_.~a-zA-Z0-9]+)/);
            vn(e = t ? t[1] : e) ? (n.val(e),
            _n(e)) : (ae(se),
            ae(ce))
        }
    }
    function ae(e) {
        var n = $("#" + e);
        n && n[0] && n[0].classList.remove("hide")
    }
    function le(e) {
        var n = $("#" + e);
        return n && n[0] && (n[0].classList.add("hide"),
        1)
    }
    function y(e) {
        var n = $("#" + e);
        n && n[0] && n[0].classList.remove("Locked")
    }
    function D(e) {
        var n = $("#" + e);
        n && n[0] && n[0].classList.add("Locked")
    }
    function ie(e, n, t, r, a) {
        var l = $("#" + e);
        l && l[0] && (t ? l.html(n) : l.text(n),
        r) && Mn(l[0], a, r)
    }
    function kn(e, n, t, r, a) {
        if (S) {
            var l = e + "-empty"
              , i = e + "-large"
              , o = e + "-medium"
              , u = e + "-dedication"
              , s = e + "-conviction"
              , d = e + "-revelation"
              , c = e + "-buttons"
              , f = e + "-socket"
              , h = e + "-gem"
              , g = e + "-vessel";
            if (null != n) {
                le(l),
                le(i),
                le(f);
                var v = Z.find(e=>e.id === n);
                if (v) {
                    An(e, v);
                    var m = u
                      , p = s
                      , k = v
                      , A = a;
                    if (k) {
                        var $, w, b, I, u = m + "-value", s = S.SmallPerkInfos[k.smallPerkId];
                        let e = ""
                          , n = "";
                        k.smallPerkHasSecondaryEffect ? (T = S.SmallPerkInfos[0],
                        $ = S.SmallPerkInfos[1],
                        b = C(T.Name),
                        G = C($.Name),
                        w = W(T.FormatType, k.smallPerkPrimaryEffectValue),
                        I = W($.FormatType, k.smallPerkSecondaryEffectValue),
                        w = "" + w + b,
                        I = "" + I + G,
                        e = w + "<br>" + I,
                        A && (w = W(T.FormatType, k.smallPerkPrimaryEffectIncrease),
                        I = W($.FormatType, k.smallPerkSecondaryEffectIncrease),
                        T = "" + w + b,
                        $ = "" + I + G,
                        n = T + "<br>" + $)) : (w = C(s.Name),
                        b = W(s.FormatType, k.smallPerkPrimaryEffectValue),
                        e = "" + b + w,
                        A && (I = W(s.FormatType, k.smallPerkPrimaryEffectIncrease),
                        n = "" + I + w)),
                        A && (n = S.SmallPerkInfos.PerSmallPerkCaption + "<br>" + n,
                        s.LongInfo) && (n = s.LongInfo + "<br><br>" + n),
                        ie(u, e, !0),
                        (0 === k.currentSkillPoints ? D : y)(u),
                        wn(m, S.SmallPerkInfos, "", n);
                        var G = p + "-value"
                          , Q = S.MediumPerkInfos[k.mediumPerkId];
                        let t = ""
                          , r = "";
                        switch (k.mediumPerkCategory) {
                        case P.v:
                            t = C(Q.Name) + "<br>",
                            t += xn(k.mediumPerkValue, Q, !0),
                            A && (r = S.MediumPerkInfos.AugGeneralInfo);
                            break;
                        case P.g:
                            var R = W(Q.FormatType, k.mediumPerkValue);
                            t = "" + R + C(Q.Name),
                            A && (r = S.MediumPerkInfos.GeneralInfo);
                            break;
                        case P.h:
                            t = W(Q.FormatType, k.mediumPerkValue),
                            t = (t += C(Q.Name) + "<br>") + Q.LongInfo,
                            A && (r = S.MediumPerkInfos.GeneralInfo);
                            break;
                        case P.u:
                            R = Bn(Q.LongInfo);
                            t = C(Q.Name) + "<br>",
                            t = (t += `<span title="${R}">`) + R + "</span>",
                            A && (r = S.MediumPerkInfos.GeneralInfo);
                            break;
                        case P.m:
                            t = C(Q.Name) + "<br>",
                            t += Q.LongInfo,
                            A && (r = S.MediumPerkInfos.GeneralInfo);
                            break;
                        default:
                            P.p;
                            t = C(Q.Name) + "<br>",
                            t += Bn(Q.LongInfo),
                            A && (r = S.MediumPerkInfos.GeneralInfo)
                        }
                        ie(G, t, !0),
                        (!(k.mediumPerkCategory === P.v && 1 <= k.mediumPerkValue) && k.fillPercent < 1 ? D : y)(G),
                        wn(p, S.MediumPerkInfos, "", r)
                    }
                    ae(o),
                    (v.unlocked && v.editable ? ae : le)(c)
                }
            } else if (null != t) {
                le(l),
                le(o),
                le(f);
                var T = K.find(e=>e.id === t);
                T && (An(e, T),
                m = d,
                p = a,
                (L = T) && ($ = m + "-name",
                s = m + "-description",
                u = `(${S.LargePerkLevelNames[L.level]})`,
                v = S.LargePerkInfos,
                c = v[L.largePerkId],
                d = C(c.Name),
                _ = p ? v.GeneralInfo : "",
                bn(m, Ge, L.largePerkId, ["LargePerkIcon"]),
                M = p ? c.LongInfoPerLevel[L.level] : "",
                ie($, d, !1, M, d),
                ie(s, c.ShortInfo),
                (0 === L.level ? (D($),
                D) : (y($),
                y))(s),
                wn(m, v, u, _)),
                ae(i))
            } else if (null != r) {
                An(e, null),
                le(l),
                le(o),
                le(i);
                var M = K.find(e=>e.id === r);
                if (M) {
                    var L = h
                      , x = g
                      , B = M;
                    if (B) {
                        d = S.BasicModEffectInfos,
                        c = S.SupremeModInfos,
                        s = S.VesselInfos;
                        if (d && c && s) {
                            var u = L + "-name"
                              , _ = L + "-mod1"
                              , h = L + "-mod2"
                              , g = L + "-mod3";
                            let e = 0
                              , n = s.NoGemInVesselInfo;
                            B.hasGem && (e = B.gemQuality + 1,
                            n = s.GemNames[B.gemQuality][z]);
                            var q = a ? s.GemInfo : ""
                              , u = (ie(u, n, !1, q, n),
                            Qn(_, B.keyBasicMod1, B.valueBasicMod1, d),
                            Qn(h, B.keyBasicMod2, B.valueBasicMod2, d),
                            !function(n, t, e) {
                                if (t < 0)
                                    ie(n, "");
                                else {
                                    var r = e[t];
                                    if (r) {
                                        let e = r.EffectInfo;
                                        r.Name && (e = C(r.Name, !0) + "<br>" + r.EffectInfo),
                                        -1 === Ne.indexOf(t) && (e = `<div class="InvalidMod ColorRed">${e}</div>`),
                                        ie(n, e, !0)
                                    } else
                                        ie(n, "")
                                }
                            }(g, B.keySupremeMod, (B.valueSupremeMod,
                            c)),
                            bn(_, Le, B.keyBasicMod1, ["ModIcon"]),
                            bn(h, Le, B.keyBasicMod2, ["ModIcon"]),
                            bn(g, xe, B.keySupremeMod, ["ModIcon", "SupremeMod"]),
                            (0 < B.vesselLevel ? (y(_),
                            y) : (D(_),
                            D))(_ + "-icon"),
                            (1 < B.vesselLevel ? (y(h),
                            y) : (D(h),
                            D))(h + "-icon"),
                            (2 < B.vesselLevel ? (y(g),
                            y) : (D(g),
                            D))(g + "-icon"),
                            In(_ + "-dropdown", 1, e, B.keyBasicMod1, [B.keyBasicMod2]),
                            In(h + "-dropdown", 2, e, B.keyBasicMod2, [B.keyBasicMod1]),
                            In(g + "-dropdown", 3, e, B.keySupremeMod),
                            x + "-header")
                              , q = x + "-value"
                              , d = s.VesselActivation[B.vesselLevel]
                              , c = a ? s.VesselInfo : "";
                            ie(u, d, !1, c, d),
                            s.ExtraDamageHealingDisplayName ? (_ = `+${B.vesselDamageHealingBonus} ` + s.ExtraDamageHealingDisplayName,
                            ie(q, _)) : ie(q, ""),
                            (B.hasGem && B.vesselLevel === e ? y : D)(q)
                        }
                    }
                    ae(f)
                }
            } else
                An(e, null),
                le(o),
                le(i),
                le(f),
                ae(l)
        }
    }
    function An(e, n) {
        var t, r, a, l, i, o = e + "-bar";
        (n ? (l = o + "-filling",
        t = o + "-text",
        r = n.maxSkillPoints || 0,
        a = Math.min(n.currentSkillPoints || 0, r),
        (l = $("#" + l)) && l[0] && (i = 0 === r ? 0 : Math.round(a / r * 1e3) / 10,
        l[0].style.width = i + "%"),
        ie(t, a + "/" + r),
        ae) : le)(o)
    }
    function $n(e, n) {
        var t = $("#" + a + "_" + e);
        t && t[0] && (t[0].checked = n)
    }
    function wn(e, n, t, r) {
        var a = $("#" + e + "-header");
        if (a && a[0] && n && n.DisplayName) {
            a.empty();
            let e = n.DisplayName;
            t && (e = e + " " + t),
            a.text(e),
            r && Mn(a[0], n.DisplayName, r)
        }
    }
    function bn(e, n, t, r=[], a=!1) {
        var l = $("#" + e + "-icon");
        if (l && l[0] && (l.empty(),
        n))
            if (a && t < 0)
                l[0].style = "",
                l[0].className = "";
            else {
                var i, o = n.height;
                l[0].style = `min-width: ${o}px; max-width: ${o}px; height: ${o}px;`;
                for (let e = 0; e < r.length; e++)
                    l[0].classList.add(r[e]);
                -1 < t && ((i = document.createElement("img")).setAttribute("src", n.getAttribute("src")),
                i.style = `margin-left: -${t * o}px;`,
                l[0].appendChild(i))
            }
    }
    function In(e, r, n, l, i=[]) {
        const o = $(`select[name="${e}"]`);
        if (o && o[0]) {
            o.empty();
            const d = S.BasicModEffectInfos
              , c = S.SupremeModInfos;
            let t = null;
            if (n <= r && ((t = document.createElement("option")).setAttribute("value", -1),
            t.textContent = "(no Mod)",
            o[0].appendChild(t)),
            n + 1 < r)
                o[0].setAttribute("disabled", !0);
            else {
                o[0].removeAttribute("disabled");
                let a = !1;
                if (3 === r) {
                    if (Ne.sort((e,n)=>{
                        var t = c[e]
                          , r = c[n];
                        return t.SummaryPriority !== r.SummaryPriority ? t.SummaryPriority - r.SummaryPriority : t.NameSummary > r.NameSummary ? 1 : -1
                    }
                    ),
                    Ne.forEach(n=>{
                        var t = c[n];
                        if (t && (!i.includes(n) || n === l)) {
                            var r = document.createElement("option");
                            r.setAttribute("value", n);
                            let e = t.EffectInfo;
                            t.Name && (e = `${C(t.Name, !0)} (${e})`),
                            r.textContent = e,
                            a || n !== l || (a = !0,
                            r.setAttribute("selected", !0)),
                            o[0].appendChild(r)
                        }
                    }
                    ),
                    !a)
                        if (-1 < l) {
                            var u = c[l];
                            if (u) {
                                var s = document.createElement("option");
                                s.setAttribute("value", l);
                                let e = u.EffectInfo;
                                u.Name && (e = `${C(u.Name, !0)} (${e})`),
                                s.textContent = e,
                                s.setAttribute("selected", !0),
                                o[0].appendChild(s)
                            }
                        } else
                            t && t.setAttribute("selected", !0)
                } else {
                    let e = []
                      , n = [];
                    1 === r ? (e = Fe,
                    n = He) : 2 === r && (e = He,
                    n = Fe),
                    (e = -1 < l && !e.find(e=>e.id === l) && (u = n.find(e=>e.id === l)) ? e.concat(u) : e).forEach(e=>{
                        var n, t;
                        i.includes(e.id) && e.id !== l || (n = Gn(e.effects, d)).length && ((t = document.createElement("option")).setAttribute("value", e.id),
                        t.textContent = n.join(" / "),
                        a || e.id !== l || (a = !0,
                        t.setAttribute("selected", !0)),
                        o[0].appendChild(t))
                    }
                    ),
                    !a && t && t.setAttribute("selected", !0)
                }
            }
        }
    }
    function Gn(e, n) {
        if (!e || !e.length || !n)
            return [];
        var t = [];
        for (let i = 0; i < e.length; i++) {
            var r, a = e[i].id, l = e[i].value, a = n[a];
            a && (r = (r = "") + Ln(a.FormatType, l) + C(a.Name),
            t.push(r))
        }
        return t
    }
    function Qn(e, n, t, r) {
        var a;
        !(n < 0) && (a = Gn(t, r)).length ? ie(e, a.join("<br>"), !0) : ie(e, "")
    }
    function Rn() {
        if (S) {
            let e = [];
            const w = S.SmallPerkInfos
              , b = (w && (e = We.map(e=>{
                var n = w[e.id]
                  , t = {};
                return t.name = C(n.Name),
                t.value = W(n.FormatType, e.value),
                t.Y = t.name,
                t.ee = n.LongInfo,
                t
            }
            )),
            []);
            var t, r, a, l, i = S.MediumPerkInfos;
            if (i) {
                for (let e = 0; e < Ce.length; e++) {
                    var o, u, s = Ce[e];
                    0 !== s.value && (o = i[s.id]) && (u = s.category === P.v ? xn(s.value, o) : o.LongInfo,
                    t = s,
                    a = C((r = o).Name),
                    l = u,
                    (s = {}).name = a,
                    s.value = W(r.FormatType, t.value),
                    s.Y = a,
                    s.ee = l,
                    s.priority = r.SummaryPriority,
                    b.push(s))
                }
                b.sort((e,n)=>e.priority !== n.priority ? e.priority - n.priority : e.name > n.name ? 1 : -1)
            }
            let n = [];
            const I = S.LargePerkInfos
              , G = (I && ((n = K.map(e=>{
                var n = I[e.largePerkId]
                  , t = {};
                return t.name = C(n.Name),
                t.value = S.LargePerkLevelNames[e.level],
                t.Y = t.name,
                t.ee = n.LongInfoPerLevel[e.level],
                t
            }
            )).sort((e,n)=>e.name > n.name ? 1 : -1),
            (v = {}).name = I.ExtraDamageHealingDisplayName,
            v.value = "+" + Oe,
            v.Y = v.name,
            v.ee = I.ExtraDamageHealingInfo,
            n.unshift(v)),
            []);
            var d, c, f, h = S.BasicModEffectInfos, g = S.SupremeModInfos, v = S.VesselInfos;
            if (h && g && v) {
                function m(e, n, t, r) {
                    var a = {};
                    a.name = t,
                    a.value = Ln(n.FormatType, e),
                    a.Y = t,
                    a.ee = r || "",
                    a.priority = n.SummaryPriority,
                    G.push(a)
                }
                for (let e = 0; e < Ee.length; e++) {
                    var p, k = Ee[e];
                    0 !== k.value && (p = h[k.id]) && m(k.value, p, C(p.Name), p.LongInfo)
                }
                for (let n = 0; n < Ue.length; n++) {
                    var A, $ = Ue[n];
                    0 !== $.value && (A = g[$.id]) && m($.category === P.A ? $.count : $.value, A, C(A.NameSummary), (c = A.EffectInfoSummary,
                    f = $.value,
                    c ? c.replaceAll("<ReplaceMe>", f) : ""))
                }
                G.sort((e,n)=>e.priority !== n.priority ? e.priority - n.priority : e.name > n.name ? 1 : -1),
                0 < Ve && ((d = {}).name = v.ExtraDamageHealingDisplayName,
                d.value = "+" + Ve,
                d.Y = d.name,
                d.ee = v.VesselInfo,
                G.unshift(d))
            }
            Tn(U, e),
            Tn(F, b),
            Tn(he, n),
            Tn(ge, G)
        }
    }
    function Tn(e, n) {
        var t, r, a = $("#" + e);
        if (a && a[0])
            if (a.empty(),
            0 === n.length)
                (t = document.createElement("tr")).classList.add("Even"),
                (r = document.createElement("td")).setAttribute("colspan", 2),
                r.textContent = "none",
                t.appendChild(r),
                a[0].appendChild(t);
            else
                for (i = 0; i < n.length; i++) {
                    var l = n[i]
                      , o = document.createElement("tr")
                      , u = (o.classList.add(i % 2 ? "Odd" : "Even"),
                    document.createElement("td"))
                      , s = document.createElement("span")
                      , d = (s.textContent = l.name,
                    document.createElement("td"))
                      , c = document.createElement("span");
                    c.textContent = l.value,
                    c.classList.add("PerksSummaryValue"),
                    u.appendChild(s),
                    d.appendChild(c),
                    Mn(d, l.Y, l.ee),
                    o.appendChild(u),
                    o.appendChild(d),
                    a[0].appendChild(o)
                }
    }
    function Mn(e, n, t) {
        if (e && t) {
            e.style.position = "relative";
            const i = `<p>${function(e) {
                letn = "";
                return n = (n = e.replace(/<font color='#ffffff'>(.*?)<\/font>/gi, '<span class="Highlight">$1</span>')).replace(/<\/?font[^>]*>/gi, "")
            }(t)}</p>`;
            var r = document.createElement("div")
              , a = (r.classList.add("PerkTooltipContainer"),
            document.createElement("span"))
              , l = (a.classList.add("HelperDivIndicator"),
            a.addEventListener("mouseover", function() {
                var e = $("#HelperDivText");
                e && e[0] && e[0].classList.add("LeftAlign"),
                ActivateHelperDiv($(this), n, i, "")
            }),
            a.addEventListener("mouseout", function() {
                var e = $("#HelperDivText");
                e && e[0] && e[0].classList.remove("LeftAlign"),
                DeactivateHelperDiv()
            }),
            document.createElement("img"));
            l.src = d,
            l.setAttribute("alt", "tooltip icon"),
            a.appendChild(l),
            r.appendChild(a),
            e.appendChild(r)
        }
    }
    function W(e, n) {
        switch (e) {
        case "NoEffectDisplay":
            return "";
        case "PlusInteger":
            return `+${n.toLocaleString("en-US")} `;
        case "PlusFullPercent":
        case "PlusPercentWithTwoFloatingpoints":
            return 0 === n ? "+0% " : n < 0 ? (n / 100).toFixed(2).toLocaleString("en-US") + "% " : `+${(n / 100).toFixed(2).toLocaleString("en-US")}% `;
        case "PercentWithTwoFloatingpoints":
            return 0 === n ? "0% " : (n / 100).toFixed(2).toLocaleString("en-US") + "% ";
        case "RomanNumerals":
            return toRomanNumeral(n) + " "
        }
        return n + " "
    }
    function Ln(e, n) {
        switch (e) {
        case "PlusInteger":
            return `+${n.toLocaleString("en-US")} `;
        case "PercentWithTwoFloatingpoints":
            return 0 === n ? "0% " : (Math.round(100 * n) / 100).toLocaleString("en-US") + "% ";
        case "PlusPercentWithUpToTwoFloatingpoints":
            return 0 === n ? "+0% " : n < 0 ? (Math.round(100 * n) / 100).toLocaleString("en-US") + "% " : `+${(Math.round(100 * n) / 100).toLocaleString("en-US")}% `;
        case "RomanNumerals":
            return toRomanNumeral(n) + " "
        }
        return n + " "
    }
    function C(e, n) {
        var t;
        return "string" != typeof e ? "" : (t = e.split("|"),
        n && 1 < t.length ? t[1] : t[0])
    }
    function xn(e, n, t) {
        var r = 1 <= e
          , a = 2 <= e
          , l = `<img src="${c}1-${r ? "active" : "inactive"}.png">`
          , i = `<img src="${c}2-${a ? "active" : "inactive"}.png">`
          , o = t ? ` title="${n.Aug1Info}"` : ""
          , u = t ? ` title="${n.Aug2Info}"` : "";
        return `<table><tr>${`<td class="AugIcon">${l}:</td>`}${`<td class="AugText${t ? " Abbr" : ""}">${`<span ${`class="${r ? "Unlocked" : "Locked"}"`}${o}>${n.Aug1Info}</span>`}</td>`}</tr><tr>${`<td class="AugIcon">${i}:</td>`}${`<td class="AugText${t ? " Abbr" : ""}">${`<span ${`class="${a ? "Unlocked" : "Locked"}"`}${u}>${n.Aug2Info}</span>`}</td>`}</tr></table>`
    }
    function Bn(e) {
        return e.replaceAll("/", " / ")
    }
    function s(d, e, c, ...f) {
        if (d || ye) {
            De = !0;
            let s = e;
            var n;
            V || (n = u.get(z),
            V = new Pe.SkillwheelPlanner(n),
            s = s || H);
            try {
                "string" == typeof s && (vn(s = s.trim()) && V.updateByCode(s) || d ? (le(se),
                le) : (ae(se),
                ae))(ce),
                c && "function" == typeof V[c] && V[c](...f),
                Z = [];
                var h = V.getSkillParameters();
                for (let e = 0; e < h.size(); e++) {
                    var g = h.get(e);
                    g.id = J.get(g.id),
                    g.mediumPerkCategory = J.get(g.mediumPerkCategory),
                    Z.push(g)
                }
                K = [];
                var v = V.getCornerParameters();
                for (let n = 0; n < v.size(); n++) {
                    var m = v.get(n);
                    if (m.id = J.get(m.id),
                    m.valueBasicMod1) {
                        var p = [];
                        for (let e = 0; e < m.valueBasicMod1.size(); e++) {
                            var k = m.valueBasicMod1.get(e);
                            p.push(k)
                        }
                        m.valueBasicMod1 = p
                    } else
                        m.valueBasicMod1 = [];
                    if (m.valueBasicMod2) {
                        var A = [];
                        for (let e = 0; e < m.valueBasicMod2.size(); e++) {
                            var $ = m.valueBasicMod2.get(e);
                            A.push($)
                        }
                        m.valueBasicMod2 = A
                    } else
                        m.valueBasicMod2 = [];
                    K.push(m)
                }
                Oe = V.getGridDamageAndHealingBonus(),
                Ve = V.getVesselsDamageAndHealingBonus(),
                We = [];
                var w = V.getSmallPerksSummary();
                for (let t = 0; t < w.size(); t++) {
                    var b = w.get(t);
                    We.push(b)
                }
                Ce = [];
                var I = V.getMediumPerksSummary();
                for (let r = 0; r < I.size(); r++) {
                    var G = I.get(r);
                    G.category = J.get(G.category),
                    Ce.push(G)
                }
                Ee = [];
                var Q = V.getGemsBasicModEffectSummary();
                for (let a = 0; a < Q.size(); a++) {
                    var R = Q.get(a);
                    Ee.push(R)
                }
                Ue = [];
                var T = V.getGemsSupremeModSummary();
                for (let l = 0; l < T.size(); l++) {
                    var M = T.get(l);
                    M.category = J.get(M.category),
                    Ue.push(M)
                }
                var L = V.getVocation()
                  , x = J.get(L)
                  , B = (x !== z && ($n(z, !1),
                $n(x, !0),
                z = x),
                Fe = [],
                V.getAvailableBasicModsPos1());
                for (let i = 0; i < B.size(); i++) {
                    var _ = B.get(i);
                    if (_.effects) {
                        var q = [];
                        for (let e = 0; e < _.effects.size(); e++) {
                            var S = _.effects.get(e);
                            q.push(S)
                        }
                        _.effects = q
                    } else
                        _.effects = [];
                    Fe.push(_)
                }
                He = [];
                var P = V.getAvailableBasicModsPos2();
                for (let o = 0; o < P.size(); o++) {
                    var y = P.get(o);
                    if (y.effects) {
                        var D = [];
                        for (let e = 0; e < y.effects.size(); e++) {
                            var W = y.effects.get(e);
                            D.push(W)
                        }
                        y.effects = D
                    } else
                        y.effects = [];
                    He.push(y)
                }
                Ne = [];
                var C = V.getAvailableSupremeMods();
                for (let u = 0; u < C.size(); u++) {
                    var E = C.get(u);
                    Ne.push(E)
                }
                var U = V.getCode()
                  , F = (U !== H && vn(U) && (H = U,
                ie(ue, H),
                ie(de, H),
                history.replaceState(null, null, "?subtopic=wheelofdestinyplanner&code=" + H),
                kn(O, X, ee, te, !0),
                kn(fe, j, Y, ne, !1),
                Rn()),
                V.getSpentSkillPoints());
                F !== N && (N = F,
                ie(oe, N)),
                (d ? (ye = !0,
                re) : un)(),
                De = !1
            } catch (t) {
                V["delete"](),
                V = null,
                De = !1
            }
        }
    }
    function _n(e) {
        e === H ? (le(se),
        le(ce)) : s(!1, e)
    }
    function qn(n) {
        var t = Z.find(e=>e.id === X);
        if (t && 1 != t.fillPercent && t.unlocked) {
            t = u.get(X);
            let e = n || 1;
            0 < (e = null != o ? Math.min(e, o - N) : e) && s(!1, null, "addToSkill", t, e)
        }
    }
    function Sn(e) {
        var n = Z.find(e=>e.id === X);
        n && 0 != n.fillPercent && n.editable && s(!1, null, "removeFromSkill", u.get(X), e || 1)
    }
    function Pn(n) {
        var t = Z.find(e=>e.id === X);
        if (t) {
            let e = n || 0;
            s(!1, null, "onGridTileRightClicked", u.get(X), e = null != o ? N >= o ? -1 : 0 < e ? Math.min(e, o - N) : (t = t.maxSkillPoints - t.currentSkillPoints,
            Math.min(t, o - N)) : e)
        }
    }
    function yn(e, n) {
        var t;
        De || (t = u.get(te)) && s(!1, null, "onModChange", e, n, t)
    }
    class Dn {
        constructor(e, n, t, r) {
            this.quarter = e.id,
            this.largePerkId = e.largePerkId,
            this.level = e.level,
            this.fillPercent = e.fillPercent,
            this.vesselLevel = e.vesselLevel,
            this.hasGem = e.hasGem,
            this.gemQuality = e.gemQuality,
            this.socketBezelImgId = e.socketBezelImgId,
            this.gemImgId = e.gemImgId,
            this.O = n,
            this.N = t,
            this.V = r,
            this.J = 270,
            this.Z = 285,
            this.ne = 311,
            this.H = 25,
            this.te = 287,
            this.X = 17,
            this.re = this.quarter == P.l || this.quarter == P.i ? 34 : 56,
            this.U = Math.round(Math.cos((this.V + 45) * m.P) * this.ne) + p,
            this.F = Math.round(Math.sin((this.V + 45) * m.P) * this.ne) + p,
            this.K = Math.round(Math.cos((this.V + this.re) * m.P) * this.te) + p,
            this.j = Math.round(Math.sin((this.V + this.re) * m.P) * this.te) + p
        }
        W(e) {
            var n = this.U - e.x
              , t = this.F - e.y;
            return Math.sqrt(n * n + t * t) <= this.H
        }
        C(e) {
            var n = this.K - e.x
              , t = this.j - e.y;
            return Math.sqrt(n * n + t * t) <= this.X
        }
    }
    if ((e = e) && (n = e.warning,
    r = e.wrapper,
    a = e.vocationRadio,
    oe = e.reqPoints,
    l = e.limitPoints,
    ue = e.code,
    f = e.codeCopy,
    w = e.codeUrl,
    b = e.codeImport,
    I = e.codeReset,
    G = e.codeInput,
    se = e.codeInvalid,
    de = e.codeMobile,
    Q = e.codeCopyMobile,
    R = e.codeUrlMobile,
    T = e.codeImportMobile,
    M = e.codeResetMobile,
    L = e.codeInputMobile,
    ce = e.codeInvalidMobile,
    O = e.selectionBox,
    x = e.maxMinus,
    B = e.minus,
    _ = e.maxPlus,
    q = e.plus,
    fe = e.infoBox,
    E = e.canvas,
    U = e.dedicationPerks,
    F = e.convictionPerks,
    he = e.revelationPerks,
    ge = e.gemPerks,
    n) && r && a && oe && l && ue && f && w && b && I && G && se && de && Q && R && T && M && L && ce && O && x && B && _ && q && fe && E && U && F && he && ge && le(n)) {
        var Wn = window.navigator.userAgent;
        if (!Wn || 0 < Wn.indexOf("MSIE ") || 0 < Wn.indexOf("Trident/"))
            ie(n, "If you are using Internet Explorer, you won't be able to use the Wheel of Destiny Planner. Please use a different browser!"),
            ae(n);
        else {
            JS_TEMPLATE_DIR = '/templates/tibiacom/';
            var Wn = new URLSearchParams(window.location.search).get("code")
              , Wn = vn(Wn) ? Wn : null
              , Cn = 1 < (Cn = t.split("version=")).length ? "?version=" + Cn[1] : ""
              , En = (d = JS_TEMPLATE_DIR + "images/global/content/info.gif",
            c = JS_TEMPLATE_DIR + "images/community/wheelofdestiny/icon-augmentation",
            Wn);
            try {
                createModule().then(e=>{
                    ae(r),
                    Pe = e,
                    e = Pe,
                    u.set(P.Knight, e.EVocation.Knight),
                    u.set(P.Druid, e.EVocation.Druid),
                    u.set(P.Sorcerer, e.EVocation.Sorcerer),
                    u.set(P.Paladin, e.EVocation.Paladin),
                    J.set(e.EVocation.Knight, P.Knight),
                    J.set(e.EVocation.Druid, P.Druid),
                    J.set(e.EVocation.Sorcerer, P.Sorcerer),
                    J.set(e.EVocation.Paladin, P.Paladin),
                    u.set(P.t, e.EQuarter.TL),
                    u.set(P.l, e.EQuarter.TR),
                    u.set(P.i, e.EQuarter.BL),
                    u.set(P.o, e.EQuarter.BR),
                    J.set(e.EQuarter.TL, P.t),
                    J.set(e.EQuarter.TR, P.l),
                    J.set(e.EQuarter.BL, P.i),
                    J.set(e.EQuarter.BR, P.o),
                    u.set(P.QTL0, e.EGridTile.QTL0),
                    u.set(P.QTL1, e.EGridTile.QTL1),
                    u.set(P.QTL2, e.EGridTile.QTL2),
                    u.set(P.QTL3, e.EGridTile.QTL3),
                    u.set(P.QTL4, e.EGridTile.QTL4),
                    u.set(P.QTL5, e.EGridTile.QTL5),
                    u.set(P.QTL6, e.EGridTile.QTL6),
                    u.set(P.QTL7, e.EGridTile.QTL7),
                    u.set(P.QTL8, e.EGridTile.QTL8),
                    u.set(P.QTR0, e.EGridTile.QTR0),
                    u.set(P.QTR1, e.EGridTile.QTR1),
                    u.set(P.QTR2, e.EGridTile.QTR2),
                    u.set(P.QTR3, e.EGridTile.QTR3),
                    u.set(P.QTR4, e.EGridTile.QTR4),
                    u.set(P.QTR5, e.EGridTile.QTR5),
                    u.set(P.QTR6, e.EGridTile.QTR6),
                    u.set(P.QTR7, e.EGridTile.QTR7),
                    u.set(P.QTR8, e.EGridTile.QTR8),
                    u.set(P.QBL0, e.EGridTile.QBL0),
                    u.set(P.QBL1, e.EGridTile.QBL1),
                    u.set(P.QBL2, e.EGridTile.QBL2),
                    u.set(P.QBL3, e.EGridTile.QBL3),
                    u.set(P.QBL4, e.EGridTile.QBL4),
                    u.set(P.QBL5, e.EGridTile.QBL5),
                    u.set(P.QBL6, e.EGridTile.QBL6),
                    u.set(P.QBL7, e.EGridTile.QBL7),
                    u.set(P.QBL8, e.EGridTile.QBL8),
                    u.set(P.QBR0, e.EGridTile.QBR0),
                    u.set(P.QBR1, e.EGridTile.QBR1),
                    u.set(P.QBR2, e.EGridTile.QBR2),
                    u.set(P.QBR3, e.EGridTile.QBR3),
                    u.set(P.QBR4, e.EGridTile.QBR4),
                    u.set(P.QBR5, e.EGridTile.QBR5),
                    u.set(P.QBR6, e.EGridTile.QBR6),
                    u.set(P.QBR7, e.EGridTile.QBR7),
                    u.set(P.QBR8, e.EGridTile.QBR8),
                    J.set(e.EGridTile.QTL0, P.QTL0),
                    J.set(e.EGridTile.QTL1, P.QTL1),
                    J.set(e.EGridTile.QTL2, P.QTL2),
                    J.set(e.EGridTile.QTL3, P.QTL3),
                    J.set(e.EGridTile.QTL4, P.QTL4),
                    J.set(e.EGridTile.QTL5, P.QTL5),
                    J.set(e.EGridTile.QTL6, P.QTL6),
                    J.set(e.EGridTile.QTL7, P.QTL7),
                    J.set(e.EGridTile.QTL8, P.QTL8),
                    J.set(e.EGridTile.QTR0, P.QTR0),
                    J.set(e.EGridTile.QTR1, P.QTR1),
                    J.set(e.EGridTile.QTR2, P.QTR2),
                    J.set(e.EGridTile.QTR3, P.QTR3),
                    J.set(e.EGridTile.QTR4, P.QTR4),
                    J.set(e.EGridTile.QTR5, P.QTR5),
                    J.set(e.EGridTile.QTR6, P.QTR6),
                    J.set(e.EGridTile.QTR7, P.QTR7),
                    J.set(e.EGridTile.QTR8, P.QTR8),
                    J.set(e.EGridTile.QBL0, P.QBL0),
                    J.set(e.EGridTile.QBL1, P.QBL1),
                    J.set(e.EGridTile.QBL2, P.QBL2),
                    J.set(e.EGridTile.QBL3, P.QBL3),
                    J.set(e.EGridTile.QBL4, P.QBL4),
                    J.set(e.EGridTile.QBL5, P.QBL5),
                    J.set(e.EGridTile.QBL6, P.QBL6),
                    J.set(e.EGridTile.QBL7, P.QBL7),
                    J.set(e.EGridTile.QBL8, P.QBL8),
                    J.set(e.EGridTile.QBR0, P.QBR0),
                    J.set(e.EGridTile.QBR1, P.QBR1),
                    J.set(e.EGridTile.QBR2, P.QBR2),
                    J.set(e.EGridTile.QBR3, P.QBR3),
                    J.set(e.EGridTile.QBR4, P.QBR4),
                    J.set(e.EGridTile.QBR5, P.QBR5),
                    J.set(e.EGridTile.QBR6, P.QBR6),
                    J.set(e.EGridTile.QBR7, P.QBR7),
                    J.set(e.EGridTile.QBR8, P.QBR8),
                    u.set(P.u, e.EMediumPerkCategory.Unique),
                    u.set(P.h, e.EMediumPerkCategory.SkillBonus),
                    u.set(P.g, e.EMediumPerkCategory.Leech),
                    u.set(P.v, e.EMediumPerkCategory.Augmentation),
                    u.set(P.m, e.EMediumPerkCategory.VesselResonance),
                    u.set(P.p, e.EMediumPerkCategory.Other),
                    J.set(e.EMediumPerkCategory.Unique, P.u),
                    J.set(e.EMediumPerkCategory.SkillBonus, P.h),
                    J.set(e.EMediumPerkCategory.Leech, P.g),
                    J.set(e.EMediumPerkCategory.Augmentation, P.v),
                    J.set(e.EMediumPerkCategory.VesselResonance, P.m),
                    J.set(e.EMediumPerkCategory.Other, P.p),
                    u.set(P.k, e.ESupremeModCategory.ModEffect),
                    u.set(P.A, e.ESupremeModCategory.ModAugmentation),
                    u.set(P.$, e.ESupremeModCategory.ModRevelation),
                    J.set(e.ESupremeModCategory.ModEffect, P.k),
                    J.set(e.ESupremeModCategory.ModAugmentation, P.A),
                    J.set(e.ESupremeModCategory.ModRevelation, P.$),
                    s(!0, En)
                }
                )["catch"](e=>{
                    ie(n, "It appears that your browser version is too old to use the Wheel of Destiny Planner. Please use a different browser!"),
                    ae(n)
                }
                )
            } catch (Zn) {
                ie(n, "Loading the Wheel of Destiny Planner failed. Please check if your browser or plugins are blocking the loading process!"),
                ae(n)
            }
            {
                e = JS_TEMPLATE_DIR + "images/community/wheelofdestiny";
                var Un = JS_TEMPLATE_DIR + "images/global/common/skillwheel";
                var Fn = Cn;
                const Kn = new Image
                  , jn = (Kn.src = e + "/backdrop_skillwheel.png",
                Kn.onload = function() {
                    ve = Kn,
                    re()
                }
                ,
                new Image)
                  , Xn = (jn.src = e + "/backdrop_skillwheel_largebonus_socketdisabled.png",
                jn.onload = function() {
                    me = jn,
                    re()
                }
                ,
                new Image)
                  , Yn = (Xn.src = e + "/backdrop_skillwheel_largebonus_socketenabled.png",
                Xn.onload = function() {
                    pe = Xn,
                    re()
                }
                ,
                new Image)
                  , et = (Yn.src = e + "/backdrop_skillwheel_largebonus_light.png",
                Yn.onload = function() {
                    ke = Yn,
                    re()
                }
                ,
                new Image)
                  , nt = (et.src = e + "/backdrop_skillwheel_front.png",
                et.onload = function() {
                    Ae = et,
                    re()
                }
                ,
                new Image)
                  , tt = (nt.src = e + "/backdrop_skillwheel_largebonus_front0.png",
                nt.onload = function() {
                    $e = nt,
                    re()
                }
                ,
                new Image)
                  , rt = (tt.src = e + "/backdrop_skillwheel_largebonus_front1.png",
                tt.onload = function() {
                    we = tt,
                    re()
                }
                ,
                new Image)
                  , at = (rt.src = e + "/backdrop_skillwheel_largebonus_front2.png",
                rt.onload = function() {
                    be = rt,
                    re()
                }
                ,
                new Image)
                  , lt = (at.src = e + "/backdrop_skillwheel_largebonus_front3.png",
                at.onload = function() {
                    Ie = at,
                    re()
                }
                ,
                new Image)
                  , it = (lt.src = e + "/icons-skillwheel-largeperks.png" + Fn,
                lt.onload = function() {
                    Ge = lt,
                    re()
                }
                ,
                new Image)
                  , ot = (it.src = e + "/marker_largeperk.png",
                it.onload = function() {
                    Qe = it,
                    re()
                }
                ,
                new Image)
                  , ut = (ot.src = Un + "/icons-gematelier-gemvariants.png",
                ot.onload = function() {
                    Re = ot,
                    re()
                }
                ,
                new Image)
                  , st = (ut.src = e + "/icons-skillwheel-sockets.png",
                ut.onload = function() {
                    Te = ut,
                    re()
                }
                ,
                new Image)
                  , dt = (st.src = Un + "/icons-skillwheel-basicmods.png" + Fn,
                st.onload = function() {
                    Le = st,
                    re()
                }
                ,
                new Image)
                  , ct = (dt.src = Un + "/icons-skillwheel-suprememods.png" + Fn,
                dt.onload = function() {
                    xe = dt,
                    re()
                }
                ,
                new Image)
                  , ft = (ct.src = e + "/marker-skillwheelsocket.png",
                ct.onload = function() {
                    Me = ct,
                    re()
                }
                ,
                new Image)
                  , ht = (ft.src = e + "/icons-skillwheel-mediumperks.png" + Fn,
                ft.onload = function() {
                    Be = ft,
                    re()
                }
                ,
                new Image)
                  , gt = (ht.src = e + "/icons-skillwheel-smallperks.png" + Fn,
                ht.onload = function() {
                    _e = ht,
                    re()
                }
                ,
                new Image)
                  , vt = (gt.src = e + "/icon_skillwheel_vesselresonance_basic.png",
                gt.onload = function() {
                    qe = gt,
                    re()
                }
                ,
                new Image);
                vt.src = e + "/icon_skillwheel_vesselresonance_supreme.png",
                vt.onload = function() {
                    Se = vt,
                    re()
                }
            }
            on(),
            CopyTextOfElement(f, ue),
            CopyTextOfElement(Q, de),
            $("#" + w).click(function() {
                Jn($(this))
            }),
            $("#" + R).click(function() {
                Jn($(this))
            }),
            $("#" + b).click(function() {
                pn($("#" + G))
            }),
            $("#" + T).click(function() {
                pn($("#" + L))
            }),
            $("#" + I).click(function() {
                _n("")
            }),
            $("#" + M).click(function() {
                _n("")
            }),
            $("#" + L).keyup(function(e) {
                var n = $("#" + L);
                $("#" + G).val(n.val()),
                zn(e, $(this))
            }),
            $("#" + G).keyup(function(e) {
                var n = $("#" + G);
                $("#" + L).val(n.val()),
                zn(e, $(this))
            }),
            mn(P.Knight),
            mn(P.Druid),
            mn(P.Sorcerer),
            mn(P.Paladin);
            {
                const mt = $("#" + l);
                mt.on("input blur", function(e) {
                    var n = mt.val().trim().replace(/[^0-9]/g, "").slice(0, 4);
                    if (mt.val(n),
                    /^[0-9]+$/.test(n)) {
                        n = parseInt(n);
                        if (!isNaN(n) && Number.isInteger(n) && 0 < n)
                            return void (o = n)
                    }
                    o = null
                })
            }
            {
                const pt = $("#" + x)
                  , kt = $("#" + _)
                  , At = $("#" + B)
                  , $t = $("#" + q);
                let r = undefined
                  , a = !1
                  , l = null;
                function Hn(e, n, t) {
                    if (("mousedown" != e.type || 1 == e.which) && (hn(e),
                    l = X,
                    n(t),
                    !a & !t)) {
                        a = !0;
                        let e = 0;
                        r = setInterval(()=>{
                            l !== X ? Nn() : e < 15 ? e++ : n(t)
                        }
                        , 30)
                    }
                }
                function Nn() {
                    clearInterval(r),
                    a = !1,
                    l = null
                }
                function On(e, n, t, r, a) {
                    switch (e.code) {
                    case "Space":
                    case "Enter":
                        r && (hn(e),
                        r(a));
                        break;
                    case "ArrowLeft":
                        hn(e),
                        n && n.focus();
                        break;
                    case "ArrowRight":
                        hn(e),
                        t && t.focus()
                    }
                }
                function Vn(e) {
                    return e = e.originalEvent || e,
                    DeactivateHelperDiv(),
                    e.touches && 1 < e.touches.length
                }
                At.on("keydown", function(e) {
                    On(e, pt, $t, Sn, gn(e))
                }),
                At.on("mousedown touchstart", function(e) {
                    Vn(e) || Hn(e, Sn, gn(e))
                }),
                At.on("mouseup mouseout touchend touchcancel", function() {
                    Nn()
                }),
                $t.on("keydown", function(e) {
                    On(e, At, kt, qn, gn(e))
                }),
                $t.on("mousedown touchstart", function(e) {
                    Vn(e) || Hn(e, qn, gn(e))
                }),
                $t.on("mouseup mouseout touchend touchcancel", function() {
                    Nn()
                }),
                pt.on("keydown", function(e) {
                    On(e, null, At)
                }),
                pt.click(function() {
                    var e;
                    Nn(),
                    (e = Z.find(e=>e.id === X)) && 0 != e.fillPercent && e.editable && s(!1, null, "clearSkill", u.get(X))
                }),
                kt.on("keydown", function(e) {
                    On(e, $t, null)
                }),
                kt.click(function() {
                    var e, n;
                    Nn(),
                    (e = Z.find(e=>e.id === X)) && 1 != e.fillPercent && e.unlocked && (n = u.get(X),
                    null != o ? N < o && (e = e.maxSkillPoints - e.currentSkillPoints,
                    e = Math.min(e, o - N),
                    s(!1, null, "addToSkill", n, e)) : s(!1, null, "fillSkill", n))
                }),
                $(window).scroll(function(e) {
                    Nn()
                })
            }
            {
                const wt = O + "-gem-mod1-dropdown"
                  , bt = O + "-gem-mod2-dropdown"
                  , It = O + "-gem-mod3-dropdown"
                  , Gt = $(`select[name="${wt}"]`)
                  , Qt = $(`select[name="${bt}"]`)
                  , Rt = $(`select[name="${It}"]`);
                Gt.change(function(e) {
                    yn(1, $(this).val()),
                    Gt.focus()
                }),
                Qt.change(function(e) {
                    yn(2, $(this).val()),
                    Qt.focus()
                }),
                Rt.change(function(e) {
                    yn(3, $(this).val()),
                    Rt.focus()
                })
            }
            $.getJSON(t).done(e=>{
                S = e,
                Rn(),
                S.SliceRightClickInfo && ie(fe + "-fillinfo", S.SliceRightClickInfo),
                S.SmallPerkInfos.DisplayName && ie(U + "-header", S.SmallPerkInfos.DisplayName + "s"),
                S.MediumPerkInfos.DisplayName && ie(F + "-header", S.MediumPerkInfos.DisplayName + "s"),
                S.LargePerkInfos.DisplayName && ie(he + "-header", S.LargePerkInfos.DisplayName + "s"),
                S.VesselInfos.DisplayName && ie(ge + "-header", S.VesselInfos.DisplayName + "s")
            }
            )
        }
    }
    function Jn(e) {
        var n, t = window.location.href;
        t && ((n = document.createElement("input")).style = "position: absolute; left: -1000px; top: -1000px; opacity: 0;",
        n.value = t,
        document.body.appendChild(n),
        n.select(),
        document.execCommand("copy"),
        document.body.removeChild(n),
        e.focus())
    }
    function zn(e, n) {
        "Enter" === e.code && n.val().trim() && pn(n)
    }
}
